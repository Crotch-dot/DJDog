<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Snake Game</title>
    <style>
        body {
            margin: 0;
            padding: 10px;
            background: #000;
            color: #0f0;
            font-family: monospace;
            text-align: center;
            overflow: hidden;
        }
        
        h1 {
            color: #0f0;
            font-size: 1.5em;
            margin: 5px 0;
        }
        
        #score {
            font-size: 1em;
            margin-bottom: 10px;
        }
        
        canvas {
            border: 2px solid #0f0;
            background: #111;
            display: block;
            margin: 0 auto 8px auto;
            width: 300px;
            height: 300px;
        }
        
        .buttons {
            margin: 10px auto;
            max-width: 200px;
        }
        
        .row {
            margin: 5px 0;
        }
        
        button {
            width: 60px;
            height: 60px;
            margin: 3px;
            background: #0f0;
            color: #000;
            border: none;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 6px;
        }
        
        button:active {
            background: #090;
        }
        
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .game-over div {
            background: #000;
            border: 2px solid #0f0;
            padding: 20px;
            text-align: center;
        }
        
        .restart {
            background: #0f0;
            color: #000;
            padding: 8px 16px;
            border: none;
            font-size: 14px;
            margin-top: 10px;
            cursor: pointer;
        }
        
        .sound {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 40px;
            height: 40px;
            background: #0f0;
            color: #000;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }
        
        @media (max-width: 480px) {
            canvas {
                width: 250px;
                height: 250px;
            }
            
            button {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }
            
            .buttons {
                max-width: 170px;
            }
        }
    </style>
</head>
<body>
    <button class="sound" onclick="toggleSound()">üîä</button>
    
    <h1>SNAKE</h1>
    <div id="score">Score: 0 | High: 0</div>
    
    <canvas id="canvas" width="300" height="300"></canvas>
    
    <div class="buttons">
        <div class="row">
            <button onclick="move('up')">‚Üë</button>
        </div>
        <div class="row">
            <button onclick="move('left')">‚Üê</button>
            <button onclick="move('right')">‚Üí</button>
        </div>
        <div class="row">
            <button onclick="move('down')">‚Üì</button>
        </div>
    </div>
    
    <div class="game-over" id="gameOver">
        <div>
            <h2>GAME OVER</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <p id="highScoreMsg" style="display:none;color:#ff0">NEW HIGH SCORE!</p>
            <button class="restart" onclick="startGame()">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');
        let scoreEl = document.getElementById('score');
        let gameOverEl = document.getElementById('gameOver');
        let finalScoreEl = document.getElementById('finalScore');
        let highScoreMsgEl = document.getElementById('highScoreMsg');
        
        let gridSize = 20;
        let tileCount = 15; // 300px / 20px grid
        
        let snake = [{x: 10, y: 10}];
        let food = {};
        let dx = 0;
        let dy = 0;
        let score = 0;
        let highScore = localStorage.getItem('snakeHigh') || 0;
        let gameRunning = false;
        let soundOn = true;
        let gameSpeed = 200;
        
        // Audio context for sounds
        let audioCtx;
        try {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        } catch(e) {
            soundOn = false;
        }
        
        function playSound(freq, duration) {
            if (!soundOn || !audioCtx) return;
            let osc = audioCtx.createOscillator();
            let gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            osc.type = 'square';
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.start(audioCtx.currentTime);
            osc.stop(audioCtx.currentTime + duration);
        }
        
        function toggleSound() {
            soundOn = !soundOn;
            document.querySelector('.sound').textContent = soundOn ? 'üîä' : 'üîá';
        }
        
        function move(direction) {
            if (!gameRunning) startGame();
            
            let newDx = dx, newDy = dy;
            
            if (direction === 'up' && dy !== 1) { newDx = 0; newDy = -1; }
            else if (direction === 'down' && dy !== -1) { newDx = 0; newDy = 1; }
            else if (direction === 'left' && dx !== 1) { newDx = -1; newDy = 0; }
            else if (direction === 'right' && dx !== -1) { newDx = 1; newDy = 0; }
            
            dx = newDx;
            dy = newDy;
        }
        
        function generateFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
            
            // Don't spawn on snake
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    generateFood();
                    return;
                }
            }
        }
        
        function startGame() {
            gameRunning = true;
            snake = [{x: 10, y: 10}];
            dx = 1;
            dy = 0;
            score = 0;
            gameSpeed = 200;
            updateScore();
            generateFood();
            gameOverEl.style.display = 'none';
        }
        
        function updateScore() {
            scoreEl.textContent = `Score: ${score} | High: ${highScore}`;
        }
        
        function gameOver() {
            gameRunning = false;
            playSound(200, 0.5);
            
            finalScoreEl.textContent = score;
            
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHigh', highScore);
                highScoreMsgEl.style.display = 'block';
            } else {
                highScoreMsgEl.style.display = 'none';
            }
            
            gameOverEl.style.display = 'flex';
        }
        
        function update() {
            if (!gameRunning) return;
            
            let head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // Wall collision
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                gameOver();
                return;
            }
            
            // Self collision
            for (let segment of snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver();
                    return;
                }
            }
            
            snake.unshift(head);
            
            // Food collision
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                updateScore();
                playSound(800, 0.1);
                generateFood();
                
                // Speed up slightly as score increases
                gameSpeed = Math.max(120, 200 - Math.floor(score / 50) * 10);
            } else {
                snake.pop();
            }
        }
        
        function draw() {
            // Clear
            ctx.fillStyle = '#111';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Snake
            ctx.fillStyle = '#0f0';
            for (let i = 0; i < snake.length; i++) {
                let segment = snake[i];
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
                
                if (i === 0) {
                    ctx.fillStyle = '#090';
                    ctx.fillRect(segment.x * gridSize + 2, segment.y * gridSize + 2, gridSize - 6, gridSize - 6);
                    ctx.fillStyle = '#0f0';
                }
            }
            
            // Food
            ctx.fillStyle = '#f00';
            ctx.fillRect(food.x * gridSize + 1, food.y * gridSize + 1, gridSize - 3, gridSize - 3);
            
            // Add food glow effect
            ctx.fillStyle = '#ff0';
            ctx.fillRect(food.x * gridSize + 4, food.y * gridSize + 4, gridSize - 9, gridSize - 9);
        }
        
        function gameLoop() {
            update();
            draw();
            setTimeout(gameLoop, gameSpeed);
        }
        
        // Keyboard controls
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowUp' || e.key === 'w') move('up');
            else if (e.key === 'ArrowDown' || e.key === 's') move('down');
            else if (e.key === 'ArrowLeft' || e.key === 'a') move('left');
            else if (e.key === 'ArrowRight' || e.key === 'd') move('right');
        });
        
        // Touch/swipe controls
        let startX, startY;
        canvas.addEventListener('touchstart', function(e) {
            e.preventDefault();
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        });
        
        canvas.addEventListener('touchend', function(e) {
            e.preventDefault();
            if (!startX || !startY) return;
            
            let endX = e.changedTouches[0].clientX;
            let endY = e.changedTouches[0].clientY;
            let diffX = startX - endX;
            let diffY = startY - endY;
            
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (diffX > 30) move('left');
                else if (diffX < -30) move('right');
            } else {
                if (diffY > 30) move('up');
                else if (diffY < -30) move('down');
            }
            
            startX = null;
            startY = null;
        });
        
        // Initialize
        updateScore();
        generateFood();
        gameLoop();
        
        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            let now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>